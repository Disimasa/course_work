#ifndef NEURAL_NETWORK_NETWORK_H
#define NEURAL_NETWORK_NETWORK_H
#include <vector>
#include "Layer.h"
#include "FullyConnected.h"
#include "Convolutional.h"
#include <string>
/// –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
class Network {
public:
	Network() = default;
	~Network();
	/// –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π —Å–ª–æ–π –≤ –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å
	void addLayer(Layer *layer);
	/// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ—Å–æ–≤
	void setWeights(std::vector<Matrix> weights);
	/// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ—Å–æ–≤
	void setRandomWeights();
	/// –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–µ—Å—ã —Å–µ—Ç–∏ –≤ —Ñ–∞–π–ª –ø–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É –ø—É—Ç–∏
	void recordWeights(std::string path);
	/// –°—á–∏—Ç—ã–≤–∞–µ—Ç –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–µ—Å–∞ –∏–∑ —Ñ–∞–π–ª–∞ –ø–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É –ø—É—Ç–∏
	void readWeights(std::string path);
	/// –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –≤—Å–µ —Å–ª–æ–∏ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç prediction
	std::vector<Matrix> activate(Matrix input);
	/// –§—É–Ω–∫—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
	///
	/// –ö–∞–∂–¥—É—é —ç–ø–æ—Ö—É —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–∏ –æ–±—É—á–µ–Ω–∏—è
	///
	/// \param input - –¥–∞—Ç–∞—Å—ç—Ç –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
	/// \param answers - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
	/// \param epochs - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
	/// \param learningRate - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–µ—Å–æ–≤ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏
	/// \return - prediction –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

	Matrix train(Matrix input, Matrix answers, int epochs, double learningRate);
	void printTopology();
private:
	std::vector<Layer*> layers;
};


/**
 * @mainpage
 * ü§ñ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π —Ä–∞–∑–Ω–æ–π —Ç–æ–ø–æ–ª–æ–≥–∏–∏.
 *
 * üî® –ï–µ —Ñ—É–Ω–∫—Ü–∏–∏:
 * - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.
 * - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–ª–æ–µ–≤ —Å –∑–∞–¥–∞–Ω–Ω–æ–π —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π.
 * - –û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å –≤—ã–≤–æ–¥–æ–º –æ—à–∏–±–∫–∏ –ø–æ —ç–ø–æ—Ö–∞–º.
 * - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º.
 * - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.
 *
 * üí° –í –ø–∞–ø–∫–µ examples —Ö—Ä–∞–Ω—è—Ç—Å—è –ø—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π, —Ç–∞–∫–∏—Ö –∫–∞–∫:
 * - XOR
 * - mnist
 */

#endif //NEURAL_NETWORK_NETWORK_H
